
angular
    .module('inspinia')
    .directive('defaultMessages', function(){
    	return {
    		templateUrl: 'views/common/default_messages.html',
    		controller: function($rootScope, $scope, $http){
    			$http({
    				url: 'sms/default-messages',
    				method: 'get'
    			}).then(function(res){
    				$rootScope.defaultMessages = res.data;
    			});

    			$rootScope.defaultMessageChanged = function(val){
    				$rootScope.info.text = $rootScope.defaultMessages[val]['text'];
    			}
    		}
    	}
    });
angular
    .module('inspinia')
    .directive('lines', function(){
    	return {
    		templateUrl: 'views/common/lines.html',
    		controller: function($rootScope, $http){
    			$http({
					url: 'lines/to-send',
					method: 'get',
				}).then(function(res){
					$rootScope.linesToSend = res.data
				})
    		}
    	}
    });
angular
    .module('inspinia')
    .directive('sendOn', function(){
    	return {
    		templateUrl: 'views/common/scheduled_sms.html',
    		link: function($scope, element, attrs){
    			$scope.showScheculedSMS = false;

    			$scope.monthes = ['farvardin', 'ordibehesht', 'khordad', 'tir', 'mordad', 'shahrivar', 'mehr', 'aban', 'azar', 'dey', 'bahman', 'esfand'];

    			$scope.$root.$on('datetimeChanged', function(event, message){
    				$scope.$root.sendOnRootScope = message;
    			});
    		}
    	}
    });
angular
    .module('inspinia')
    .directive('socket', function(){
    	return {
    		controller: ['$rootScope', '$scope', 'SweetAlert', '$filter', function($rootScope, $scope, SweetAlert, $filter){
    			var socket = io('158.58.185.50:8890');
    			$rootScope.$watch('user', function(user){
    				if(typeof user.id == 'undefined') return;

    				socket.on('received_'+user.id, function(data){
						SweetAlert.swal({
						    title: $filter('translate')('NEW_MESSAGE'),
						    text: data.message,
						});
					});

    			}, true);
    		}],
    	}
    });
angular
    .module('inspinia')
    .directive('testSms', function(){
    	return {
    		templateUrl: 'views/common/test_sms_template.html',
    		controller: function($rootScope, $scope, $modal, $attrs){
                var brand = ($attrs.brand == 'true') ? true : false;
                var international = ($attrs.international == 'true') ? true : false;
    			$scope.openTestSMSModal = function(){
                    if(brand){
                        $modal.open({
                            templateUrl: 'views/common/test_sms_brand.html',
                        });
                    } else{ 
                        if(international){
                            $modal.open({
                                templateUrl: 'views/common/test_sms_international.html',
                            });
                        } else {
                            $modal.open({
                                templateUrl: 'views/common/test_sms.html',
                            });
                        }
                    }
                }

                $rootScope.sendTestMessageURL = 'sms/test';
    		}
    	}
    });
//# sourceMappingURL=tpanel-directives.js.map
